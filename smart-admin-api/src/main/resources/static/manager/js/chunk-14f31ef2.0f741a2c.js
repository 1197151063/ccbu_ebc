(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-14f31ef2"],{"0342":function(e,t,n){},"0e8f":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("1e04"),a={getLoadDepartment:function(){return Object(r.a)("/department/list")},getDepartmentEmployeeList:function(){return Object(r.a)("/department/listEmployee")},addDepartment:function(e){return Object(r.c)("/department/add",e)},updateDepartment:function(e){return Object(r.c)("/department/update",e)},deleteDepartment:function(e){return Object(r.c)("/department/delete/"+e)},getDepartmentById:function(e){return Object(r.a)("/department/query/"+e)},getDepartmentAll:function(){return Object(r.a)("/department/listAll")},getListEmployeeByDepartmentName:function(e){return Object(r.a)("/department/listEmployeeByDepartmentName?departmentName="+e)},upOrDown:function(e,t){return Object(r.a)("/department/upOrDown/"+e+"/"+t)},upGrade:function(e){return Object(r.a)("/department/upgrade/"+e)},downGrade:function(e,t){return Object(r.a)("/department/downgrade/"+e+"/"+t)},getProjects:function(e){return Object(r.c)("/department/sysProject/query",e)}}},"2b26":function(e,t,n){"use strict";var r=n("74c8");n.n(r).a},5534:function(e,t,n){"use strict";var r=n("9296");n.n(r).a},"6f0b":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("1e04"),a={getAllUrl:function(e){return Object(r.a)("/privilege/getAllUrl")},getMenuList:function(e){return Object(r.c)("/privilege/menu/queryAll")},addBatchSaveMenu:function(e){return Object(r.c)("/privilege/menu/batchSaveMenu",e)},addBatchSavePoints:function(e){return Object(r.c)("/privilege/function/batchSave",e)},queryPrivilegeFunctionList:function(e){return Object(r.c)("/privilege/function/query/"+e)},addOrUpdate:function(e){return Object(r.c)("/privilege/function/saveOrUpdate",e)},getRolePower:function(e){return Object(r.c)("/privilege/updateRolePrivilege",e)},getListPrivilegeByRoleId:function(e){return Object(r.a)("/privilege/listPrivilegeByRoleId/"+e)}}},"74c8":function(e,t,n){},"86ec":function(e,t,n){"use strict";n.r(t);var r=(n("7f7f"),n("96cf"),n("1da1")),a=(n("ac4d"),n("8a81"),n("1c4c"),n("6b54"),n("5df3"),n("f400"),n("ac6a"),n("53ca")),i=(n("20d6"),n("c5f6"),n("cc5e")),o=n("6f0b");function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c={name:"RoleTree",props:{roleId:{type:Number,required:!0,validator:function(e){return e>=0}}},components:{},data:function(){return{tree:[],treeMap:null,loading:!1,rolePower:{privilegeKeyList:[],roleId:""},checkedData:[]}},computed:{},watch:{roleId:function(e){e&&this.getListPrivilegeByRoleId(e)}},filters:{},created:function(){},mounted:function(){this.getListPrivilegeByRoleId(this.roleId)},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{selectCheckbox:function(e){var t=this;if(-1!==this.checkedData.indexOf(e.key)){if(this.removeCheckAndChidlrenCheck(e),e.parentKey){var n=this.treeMap.get(e.parentKey);n&&this.unCheckedParent(n)}}else!function(){t.addCheckAndChildrenCheck(e);for(var n=e.parentKey;null!=n;){var r=t.treeMap.get(n);if(r)-1==t.checkedData.findIndex(function(e){return e==n})&&t.checkedData.push(n),n=r.parentKey;else n=null}}()},unCheckedParent:function(e){if(e&&e.children&&e.children.length>0&&!this.judgeArrayExistCheck(e.children)){var t=this.checkedData.findIndex(function(t){return t==e.key});-1!=t&&this.checkedData.splice(t,1),e=this.treeMap.get(e.parentKey),this.unCheckedParent(e)}},judgeArrayExistCheck:function(e){var t=this;if(!e)return!1;var n,r=s(e);try{var i=function(){var e=n.value;if(-1!=t.checkedData.findIndex(function(t){return t==e.key}))return{v:!0}};for(r.s();!(n=r.n()).done;){var o=i();if("object"===Object(a.a)(o))return o.v}}catch(e){r.e(e)}finally{r.f()}return!1},addCheckAndChildrenCheck:function(e){var t=this;-1==this.checkedData.findIndex(function(t){return t==e.key})&&this.checkedData.push(e.key),e.children&&e.children.forEach(function(e){t.addCheckAndChildrenCheck(e)})},removeCheckAndChidlrenCheck:function(e){var t=this,n=this.checkedData.findIndex(function(t){return t==e.key});-1!=n&&this.checkedData.splice(n,1),e.children&&e.children.forEach(function(e){t.removeCheckAndChidlrenCheck(e)})},saveChange:function(){0!=this.checkedData.length?(this.rolePower.roleId=this.roleId,this.rolePower.privilegeKeyList=this.checkedData.concat(),this.getRolePower(this.rolePower)):this.$Message.error("还未选择任何权限")},getRolePower:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$Spin.show(),e.prev=1,e.next=4,o.a.getRolePower(t);case 4:return this.$Message.info("保存成功"),this.rolePower.privilegeKeyList=[],e.next=8,this.getListPrivilegeByRoleId(this.roleId);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1);case 13:return e.prev=13,this.$Spin.hide(),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[1,10,13,16]])}));return function(t){return e.apply(this,arguments)}}(),tree2map:function(e){if(e){var t,n=s(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.treeMap.set(r.key,r),this.tree2map(r.children)}}catch(e){n.e(e)}finally{n.f()}}},getListPrivilegeByRoleId:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.getListPrivilegeByRoleId(t);case 3:n=e.sent,r=n.data,this.tree=r.privilege,this.treeMap=new Map,this.tree2map(this.tree),this.checkedData=r.selectedKey||[],e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t){return e.apply(this,arguments)}}()}},u=(n("2b26"),n("2877")),d=Object(u.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"tree"}},[n("Row",[n("Col",{staticClass:"col-desc",attrs:{span:"16"}},[e._v("设置角色对应的功能操作、后台管理权限")]),n("Col",{staticClass:"button-style",attrs:{span:"8"}},[n("Button",{directives:[{name:"privilege",rawName:"v-privilege",value:"update-role-privilege",expression:"'update-role-privilege'"}],staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},nativeOn:{click:function(t){return e.saveChange()}}},[e._v("保存")])],1)],1),n("CheckboxGroup",{model:{value:e.checkedData,callback:function(t){e.checkedData=t},expression:"checkedData"}},[n("div",{staticClass:"checked-box"},[n("ul",e._l(e.tree,function(t,r){return n("li",{key:t.key},[n("div",{staticClass:"level-one"},[n("Checkbox",{attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name)+" ")])],1),e._l(t.children,function(t,r){return n("div",{key:t.key,staticClass:"level-two"},[n("Checkbox",{staticClass:"level-two-label",attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name))]),n("div",{staticClass:"level-three"},[e._l(t.children,function(t,r){return[t.children&&t.children.length>0?n("div",{key:t.key,staticClass:"isLevel-four"},[n("Checkbox",{key:t.key,staticClass:"level-three-label",attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name))]),t.children.length>0?n("div",{key:r,staticClass:"level-four"},[e._l(t.children,function(t,r){return[t.children&&t.children.length>0?[n("div",{key:t.key,staticClass:"isLevel-four"},[n("Checkbox",{staticClass:"level-three-label",attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name))]),t.children&&t.children.length>0?n("div",{staticClass:"level-four"},[e._l(t.children,function(t,r){return[n("Checkbox",{attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name))])]})],2):e._e()],1)]:[n("Checkbox",{key:t.key,attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name))])]]})],2):e._e()],1):n("Checkbox",{key:t.key,attrs:{label:t.key},nativeOn:{click:function(n){return n.preventDefault(),e.selectCheckbox(t)}}},[e._v(e._s(t.name))])]})],2)],1)})],2)}),0)])])],1)},[],!1,null,"6c3fdadb",null).exports,p={name:"RoleList",components:{DepartmentEmployeeTree:n("b5fc").a},props:{roleId:{type:Number,required:!0,validator:function(e){return e>=0}}},data:function(){var e=this;return{isShowEmployeeModal:!1,currentPage:1,isShowTablesLoading:!1,columns:[{type:"selection",width:60,align:"center"},{title:"登录名",key:"loginName"},{title:"姓名",key:"actualName"},{title:"手机号",key:"phone"},{title:"邮箱",key:"email"},{title:"部门",key:"departmentName"},{title:"操作",key:"operation ",width:100,align:"center",className:"action-hide",render:function(t,n){return e.$tableAction(t,[{title:"移除",directives:[{name:"privilege",value:"delete-employee-role"}],action:function(){e.deleteEmployee(n.index)}}])}}],employeeData:{roleId:"",pageNum:1,pageSize:10,sort:""},tableData:[],prepAddEmployees:[],submitPrepAddEmployeesData:{employeeIds:[],roleId:0},deleteIds:[],total:0,pageSize:0}},computed:{},watch:{roleId:function(e){e&&(this.employeeData.roleId=this.roleId,this.getListEmployee(this.employeeData))}},filters:{},created:function(){},mounted:function(){this.employeeData.roleId=this.roleId,this.getListEmployee(this.employeeData)},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{deleteEmployees:function(){var e={};e.employeeIds=this.deleteIds.slice(0,this.deleteIds.length),e.roleId=this.roleId,e.employeeIds.length<=0?this.$Message.error("请先选择要移除的成员"):this.deleteEmployeeList(e)},deletePrepEmployee:function(e){this.prepAddEmployees.splice(e,1)},deleteEmployeeList:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isShowTablesLoading=!0,e.prev=1,e.next=4,i.a.deleteEmployeeList(t);case 4:return e.next=6,this.getListEmployee(this.employeeData);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1);case 11:return e.prev=11,this.isShowTablesLoading=!1,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[1,8,11,14]])}));return function(t){return e.apply(this,arguments)}}(),selectChange:function(e){this.deleteIds=[];for(var t=0;t<e.length;t++)this.deleteIds.push(e[t].id)},deleteEmployee:function(e){var t={};t.employeeId=this.tableData[e].id,t.roleId=this.roleId,this.deleteEmployeeRole(t)},deleteEmployeeRole:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isShowTablesLoading=!0,e.prev=1,e.next=4,i.a.deleteEmployeeRole(t);case 4:return this.$Message.success("移除成功"),e.next=7,this.getListEmployee(this.employeeData);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.prev=12,this.isShowTablesLoading=!1,e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t){return e.apply(this,arguments)}}(),changePage:function(e){var t={};t.roleId=this.roleId,this.currentPage=e,t.pageNum=e,t.pageSize=this.pageSize,t.sort="",this.getListEmployee(t)},confirmPrepAddEmployees:function(){var e=this;this.submitPrepAddEmployeesData.employeeIds=[],this.prepAddEmployees.forEach(function(t){e.submitPrepAddEmployeesData.employeeIds.push(t.manageId)}),this.submitPrepAddEmployeesData.roleId=this.roleId,this.addEmployeeListRole(this.submitPrepAddEmployeesData),this.getListEmployee(this.employeeData)},addEmployeeListRole:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isShowTablesLoading=!0,e.prev=1,e.next=4,i.a.addEmployeeListRole(t);case 4:return this.$Message.success("添加成功"),this.employeeData.roleId=this.roleId,e.next=8,this.getListEmployee(this.employeeData);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1);case 13:return e.prev=13,this.isShowTablesLoading=!1,e.finish(13);case 16:case"end":return e.stop()}},e,this,[[1,10,13,16]])}));return function(t){return e.apply(this,arguments)}}(),addPrepEmployees:function(){var e=this.$refs.departmentEmployeeTree.getSelect(),t={},n=!0;t.manageName=e.name,t.manageId=e.id;for(var r=0;r<this.prepAddEmployees.length;r++)if(this.prepAddEmployees[r].manageId===t.manageId){n=!1;break}!0===n&&(n=!1,this.submitPrepAddEmployeesData.employeeIds.push(t.manageId),this.prepAddEmployees.push(t))},getListEmployee:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isShowTablesLoading=!0,e.prev=1,e.next=4,i.a.getListEmployee(t);case 4:return n=e.sent,this.roleList=n.data,this.total=n.data.total,this.pageSize=n.data.pageSize,this.tableData=this.roleList.list,e.next=11,this.getListAllEmployee();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1);case 16:return e.prev=16,this.isShowTablesLoading=!1,e.finish(16);case 19:case"end":return e.stop()}},e,this,[[1,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),getListAllEmployee:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t,n,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$isShowTablesLoading=!0,e.prev=1,e.next=4,i.a.getAllListEmployee(this.roleId);case 4:for(t=e.sent,n=t.data,this.prepAddEmployees=[],r=0;r<n.length;r++)(a={}).manageName=n[r].actualName,a.manageId=n[r].id,this.prepAddEmployees.push(a);e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1);case 13:return e.prev=13,this.isShowTablesLoading=!1,e.finish(13);case 16:case"end":return e.stop()}},e,this,[[1,10,13,16]])}));return function(){return e.apply(this,arguments)}}(),addEmployee:function(){this.isShowEmployeeModal=!0,this.getListAllEmployee(),this.submitPrepAddEmployeesData.employeeIds=[]}}},h=(n("5534"),Object(u.a)(p,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Row",[n("Col",{staticStyle:{margin:"20px 0","font-size":"15px",color:"#95a5a6"},attrs:{span:"16"}},[e._v("管理拥有当前角色权限的人员列表")]),n("Col",{staticStyle:{margin:"20px 0","text-align":"right"},attrs:{span:"8"}},[n("Button",{directives:[{name:"privilege",rawName:"v-privilege",value:"add-employee-role",expression:"'add-employee-role'"}],attrs:{type:"primary"},on:{click:e.addEmployee}},[e._v("添加成员")]),n("Button",{directives:[{name:"privilege",rawName:"v-privilege",value:"delete-employee-role-batch",expression:"'delete-employee-role-batch'"}],staticStyle:{"margin-left":"10px"},attrs:{type:"error"},on:{click:function(t){return e.deleteEmployees()}}},[e._v("批量移除")])],1)],1),n("Table",{ref:"selection",attrs:{columns:e.columns,data:e.tableData,loading:e.isShowTablesLoading,border:""},on:{"on-selection-change":e.selectChange}}),n("Row",{staticClass:"page",attrs:{justify:"end",type:"flex"}},[n("Col",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{order:"2",span:"24"}},[n("Page",{attrs:{current:e.currentPage,"page-size":e.pageSize,total:e.total,"show-elevator":""},on:{"on-change":e.changePage}})],1)],1),n("Modal",{staticStyle:{"min-width":"1800px"},attrs:{title:"添加成员",width:"700"},on:{"on-ok":function(t){return e.confirmPrepAddEmployees()}},model:{value:e.isShowEmployeeModal,callback:function(t){e.isShowEmployeeModal=t},expression:"isShowEmployeeModal"}},[n("Row",{staticClass:"shuttle-box"},[n("Col",{staticClass:"box",attrs:{span:"11"}},[n("Row",[n("Col",{staticClass:"title",attrs:{span:"24"}},[e._v("员工列表")])],1),n("Row",[n("Col",{staticClass:"no-scrollbar",staticStyle:{height:"290px","overflow-y":"scroll"},attrs:{id:"goRight",span:"24"},nativeOn:{dblclick:function(t){return e.getCharge(t)}}},[n("DepartmentEmployeeTree",{ref:"departmentEmployeeTree"})],1)],1)],1),n("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[n("Icon",{staticStyle:{"line-height":"350px"},attrs:{size:"30",type:"md-arrow-round-forward"},nativeOn:{click:function(t){return e.addPrepEmployees(t)}}})],1),n("Col",{staticClass:"box",attrs:{span:"11"}},[n("Row",[n("Col",{staticClass:"title",attrs:{span:"24"}},[e._v("成员列表")]),n("Col",{staticClass:"no-scrollbar",staticStyle:{"overflow-y":"scroll",height:"290px","text-align":"center"},attrs:{span:"24"}},e._l(e.prepAddEmployees,function(t,r){return n("Row",{key:r},[n("Col",{staticStyle:{"font-size":"15px","text-align":"left"},attrs:{span:"24"}},[n("icon",{attrs:{type:"ios-people"}}),e._v("\n                "+e._s(t.manageName)+"\n                "),n("Button",{attrs:{icon:"md-close",type:"text"},nativeOn:{click:function(t){return e.deletePrepEmployee(r)}}})],1)],1)}),1)],1)],1)],1)],1)],1)},[],!1,null,"e67e79c8",null)).exports,f=(n("7514"),n("1e04")),m=function(e){return Object(f.c)("/dataScope/batchSet",e)},v=function(){return Object(f.a)("/dataScope/list")},y=function(e){return Object(f.a)("/dataScope/listByRole/"+e)},g={name:"RoleDataScope",components:{},props:{roleId:{type:Number,required:!0,validator:function(e){return e>=0}}},data:function(){return{dataScopeList:{}}},computed:{},watch:{},filters:{},created:function(){},mounted:function(){this.getDataScope()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{updateDataScope:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={roleId:this.roleId,batchSetList:this.dataScopeList},e.next=4,m(t);case 4:this.$Message.success("保存成功"),this.getDataScope(this.employeeId),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),getDataScope:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v();case 3:t=e.sent,this.dataScopeList=t.data,this.getRoleDataScope(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),getRoleDataScope:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t,n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y(this.roleId);case 3:t=e.sent,n=t.data,this.dataScopeList.forEach(function(e,t){var a=n.find(function(t){return t.dataScopeType==e.dataScopeType});a?r.$set(e,"viewType",a.viewType):r.$set(e,"viewType","")}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()}},b={name:"RoleManage",components:{RoleTree:d,RoleList:h,RoleDataScope:(n("a0d4"),Object(u.a)(g,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Row",[n("Col",{staticStyle:{margin:"20px 0","font-size":"15px",color:"#95a5a6"},attrs:{span:"16"}}),n("Col",{staticClass:"button-style",attrs:{span:"8"}},[n("Button",{directives:[{name:"privilege",rawName:"v-privilege",value:"update-data-scope",expression:"'update-data-scope'"}],staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateDataScope(t)}}},[e._v("保存")]),n("Button",{directives:[{name:"privilege",rawName:"v-privilege",value:"query-data-scope",expression:"'query-data-scope'"}],attrs:{type:"warning"},nativeOn:{click:function(t){return e.getDataScope()}}},[e._v("刷新")])],1)],1),n("Row",{staticStyle:{"border-bottom":"1px solid #f2f2f2","font-weight":"600",margin:"10px 0px"}},[n("Col",{staticClass:"tab-margin",attrs:{span:"4"}},[e._v("业务单据")]),n("Col",{staticClass:"tab-data",attrs:{span:"6"}},[e._v("查看数据范围")]),n("Col",{staticClass:"tab-margin",attrs:{span:"14"}})],1),n("div",{staticClass:"no-scrollbar",staticStyle:{height:"680px","overflow-y":"scroll"}},e._l(this.dataScopeList,function(t){return n("Row",{key:t.dataScopeType,staticStyle:{"border-bottom":"1px solid #f2f2f2",margin:"10px 0px"}},[n("Col",{staticStyle:{"line-height":"100px","text-align":"center"},attrs:{span:"4"}},[e._v(e._s(t.dataScopeTypeName))]),n("Col",{staticClass:"tab-data",attrs:{span:"6"}},[n("RadioGroup",{attrs:{vertical:""},model:{value:t.viewType,callback:function(n){e.$set(t,"viewType",n)},expression:"item.viewType"}},e._l(t.viewTypeList,function(t,r){return n("Radio",{key:r+"viewType",attrs:{label:t.viewType}},[e._v(e._s(t.viewTypeName))])}),1)],1),n("Col",{staticStyle:{"text-indent":"2rem","line-height":"30px","font-size":"16px",color:"#a3a3a3"},attrs:{span:"14"}},[n("p",{staticStyle:{padding:"30px 0"}},[e._v(e._s(t.dataScopeTypeDesc))])])],1)}),1)],1)},[],!1,null,"382bf300",null)).exports},props:{},data:function(){return{roleList:{},roleId:0,isShowRemoveRoleModal:!1,isShowUpdateRoleModal:!1,isShowAddRoleModal:!1,ruleDetail:{name:"",id:"",detail:""},displayTab:1,isFirst:!0}},computed:{},watch:{},filters:{},created:function(){},mounted:function(){this.getAllRole()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{getAllRole:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.getAllRole();case 3:t=e.sent,this.roleList=t.data,this.roleList&&this.roleList.length>0&&(this.roleId=this.roleList[0].id,this.isFirst&&(this.$nextTick(function(){n.$refs.sideMenu.updateOpened(),n.$refs.sideMenu.updateActiveName()}),this.isFirst=!1)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),addRole:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$Spin.show(),e.prev=1,e.next=4,i.a.addRole(t,n);case 4:return this.hideAddRoleModal(),e.next=7,this.getAllRole();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.prev=12,this.$Spin.hide(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t,n){return e.apply(this,arguments)}}(),submitRole:function(){""!==this.ruleDetail.name&&this.ruleDetail.name.length<=20?this.addRole(this.ruleDetail.detail,this.ruleDetail.name):this.$Message.warning("请先完善角色信息")},updateRole:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$Spin.show(),e.prev=1,e.next=4,i.a.updateRole(this.ruleDetail.id,this.ruleDetail.detail,this.ruleDetail.name);case 4:return t=e.sent,this.roleList=t.data,this.hideUpdateRoleModal(),e.next=9,this.getAllRole();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:return e.prev=14,this.$Spin.hide(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])}));return function(){return e.apply(this,arguments)}}(),deleteRole:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$Spin.show(),e.prev=1,e.next=4,i.a.deleteRole(t);case 4:return this.$Message.success("删除成功"),e.next=7,this.getAllRole();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.prev=12,this.$Spin.hide(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t){return e.apply(this,arguments)}}(),deleteSingleRole:function(e){this.isShowRemoveRoleModal=!0,this.ruleDetail.id=e.id,this.ruleDetail.name=e.roleName},showUpdateRoleModal:function(e){this.isShowUpdateRoleModal=!0,this.ruleDetail.id=e.id,this.ruleDetail.name=e.roleName,this.ruleDetail.detail=e.remark},showAddRoleModal:function(){this.isShowAddRoleModal=!0,this.ruleDetail.name="",this.ruleDetail.detail=""},hideUpdateRoleModal:function(){this.isShowUpdateRoleModal=!1},hideAddRoleModal:function(){this.isShowAddRoleModal=!1},selectTab:function(e){this.displayTab=e},selectRole:function(e,t){this.roleId=e.id},confirmDeleteRole:function(){this.deleteRole(this.ruleDetail.id),this.isShowRemoveRoleModal=!1},cancelDeleteRole:function(){this.isShowRemoveRoleModal=!1}}},D=(n("c1c3"),Object(u.a)(b,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",{attrs:{gutter:10}},[n("Col",{attrs:{lg:5,md:8}},[n("Card",{staticClass:"warp-card",staticStyle:{position:"relative"},attrs:{"dis-hover":""}},[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("角色列表")]),n("div",{attrs:{slot:"extra"},slot:"extra"},[n("Button",{directives:[{name:"privilege",rawName:"v-privilege",value:"add-role",expression:"'add-role'"}],attrs:{size:"small",type:"primary"},on:{click:function(t){return e.showAddRoleModal()}}},[e._v("添加")])],1),n("Menu",{ref:"sideMenu",staticClass:"left role-list no-scrollbar",staticStyle:{height:"666px","overflow-y":"scroll",width:"100%"},attrs:{"active-name":0}},e._l(e.roleList,function(t,r){return n("MenuItem",{key:t.id,attrs:{name:r},nativeOn:{click:function(n){return e.selectRole(t,r)}}},[n("Row",[n("Col",{attrs:{span:"24"}},[n("span",{staticClass:"role-name"},[n("Tooltip",{attrs:{placement:"right"}},[n("span",[e._v(e._s(t.roleName))]),n("div",{staticClass:"suspension-box",attrs:{slot:"content"},slot:"content"},[n("p",[n("span",{directives:[{name:"privilege",rawName:"v-privilege",value:"delete-role",expression:"'delete-role'"}],on:{click:function(n){return e.deleteSingleRole(t)}}},[e._v("删除")])]),n("p",[n("span",{directives:[{name:"privilege",rawName:"v-privilege",value:"update-role",expression:"'update-role'"}],on:{click:function(n){return e.showUpdateRoleModal(t)}}},[e._v("编辑")])])])])],1)])],1)],1)}),1),n("Modal",{attrs:{title:"添加角色"},model:{value:e.isShowAddRoleModal,callback:function(t){e.isShowAddRoleModal=t},expression:"isShowAddRoleModal"}},[n("Form",{attrs:{"label-width":100,model:e.ruleDetail,"label-position":"left"}},[n("FormItem",{attrs:{label:"角色名称",required:""}},[n("Input",{attrs:{placeholder:"请输入角色名称..."},on:{"on-keydown":function(t){e.ruleDetail.name=e.ruleDetail.name.replace(/^ +| +$/g,"")},"on-keyup":function(t){e.ruleDetail.name=e.ruleDetail.name.replace(/^ +| +$/g,"")}},model:{value:e.ruleDetail.name,callback:function(t){e.$set(e.ruleDetail,"name",t)},expression:"ruleDetail.name"}})],1),n("FormItem",{attrs:{label:"备注"}},[n("Input",{attrs:{placeholder:"请输入备注",type:"textarea"},model:{value:e.ruleDetail.detail,callback:function(t){e.$set(e.ruleDetail,"detail",t)},expression:"ruleDetail.detail"}})],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:e.submitRole}},[e._v("确认")]),n("Button",{on:{click:function(t){return e.hideAddRoleModal()}}},[e._v("返回")])],1)],1),n("Modal",{attrs:{title:"修改角色"},model:{value:e.isShowUpdateRoleModal,callback:function(t){e.isShowUpdateRoleModal=t},expression:"isShowUpdateRoleModal"}},[n("Form",{attrs:{"label-width":100,model:e.ruleDetail,"label-position":"left"}},[n("FormItem",{attrs:{label:"角色名称",required:""}},[n("Input",{attrs:{placeholder:"请输入角色名称..."},on:{"on-keydown":function(t){e.ruleDetail.name=e.ruleDetail.name.replace(/^ +| +$/g,"")},"on-keyup":function(t){e.ruleDetail.name=e.ruleDetail.name.replace(/^ +| +$/g,"")}},model:{value:e.ruleDetail.name,callback:function(t){e.$set(e.ruleDetail,"name",t)},expression:"ruleDetail.name"}})],1),n("FormItem",{attrs:{label:"备注"}},[n("Input",{attrs:{placeholder:"请输入备注",type:"textarea"},model:{value:e.ruleDetail.detail,callback:function(t){e.$set(e.ruleDetail,"detail",t)},expression:"ruleDetail.detail"}})],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:e.updateRole}},[e._v("确认")]),n("Button",{on:{click:function(t){return e.hideUpdateRoleModal()}}},[e._v("返回")])],1)],1),n("Modal",{attrs:{title:"删除角色"},on:{"on-cancel":function(t){return e.cancelDeleteRole()},"on-ok":function(t){return e.confirmDeleteRole()}},model:{value:e.isShowRemoveRoleModal,callback:function(t){e.isShowRemoveRoleModal=t},expression:"isShowRemoveRoleModal"}},[e._v('确定删除"'+e._s(e.ruleDetail.name)+'"这个角色吗？')])],1)],1),n("Col",{attrs:{lg:19,md:16}},[n("Card",{staticClass:"warp-card",attrs:{"dis-hover":""}},[n("div",{staticClass:"card-title",attrs:{slot:"title"},slot:"title"},[e._v("功能列表")]),n("Menu",{staticStyle:{"z-index":"1"},attrs:{"active-name":e.displayTab,mode:"horizontal"},on:{"on-select":e.selectTab}},[n("MenuItem",{attrs:{name:1}},[n("Icon",{attrs:{type:"ios-hammer"}}),e._v("功能权限\n        ")],1),n("MenuItem",{attrs:{name:2}},[n("Icon",{attrs:{type:"ios-paper"}}),e._v("数据范围\n        ")],1),n("MenuItem",{attrs:{name:3}},[n("Icon",{attrs:{type:"ios-people"}}),e._v("成员管理\n        ")],1)],1),1==e.displayTab?n("RoleTree",{attrs:{roleId:e.roleId}}):e._e(),2==e.displayTab?n("RoleDataScope",{attrs:{roleId:e.roleId}}):e._e(),3==e.displayTab?n("RoleList",{attrs:{roleId:e.roleId}}):e._e()],1)],1)],1)},[],!1,null,"6eb61c45",null));t.default=D.exports},9296:function(e,t,n){},a0d4:function(e,t,n){"use strict";var r=n("be28");n.n(r).a},b5fc:function(e,t,n){"use strict";var r=(n("7f7f"),n("96cf"),n("1da1")),a=(n("ac6a"),n("0e8f")),i={name:"DepartmentEmployeeTreeItem",components:{},props:{itemData:{type:Object,required:!0},isDepartment:{type:Boolean,default:!1}},data:function(){return{currentStyle:{backgroundColor:"#FFF",color:"#495060",padding:"3px 8px"},hoverStyle:{backgroundColor:"#2d8cf0",color:"#FFF",padding:"3px 8px"},selectStyle:{backgroundColor:"#2d8cf0",color:"#FFF",padding:"3px 8px"},style:{backgroundColor:"#FFF",color:"#495060",padding:"3px 8px"}}},computed:{},watch:{},filters:{},created:function(){this.itemData.eventbus&&this.itemData.eventbus.$on("select",this.listenSelect)},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){this.itemData.eventbus&&this.itemData.eventbus.$off("select",this.listenSelect)},destroyed:function(){},activated:function(){},methods:{selectItem:function(){(!this.isDepartment&&this.itemData.isEmployee||this.isDepartment)&&this.itemData.selectFunction&&this.itemData.selectFunction({id:this.itemData.id,name:this.itemData.title})},listenSelect:function(e){e.id===this.itemData.id?this.itemData.selected=!0:(this.currentStyle=this.style,this.itemData.selected=!1)},onMouseover:function(){null!==this.itemData.selected&&this.itemData.selected||(this.currentStyle=this.hoverStyle)},onMouseout:function(){null!==this.itemData.selected&&this.itemData.selected||(this.currentStyle=this.style)}}},o=n("2877"),s=Object(o.a)(i,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticStyle:{display:"inline-block"},on:{click:e.selectItem}},[n("span",{style:e.itemData.selected?e.selectStyle:e.currentStyle,on:{mouseout:e.onMouseout,mouseover:e.onMouseover}},[n("Icon",{staticStyle:{"margin-right":"8px"},attrs:{type:e.itemData.icon}}),e._v("\n    "+e._s(e.itemData.title)+"\n  ")],1)])},[],!1,null,"6fb6b91c",null).exports,l=n("2b0e"),c={name:"DepartmentEmployeeTree",components:{DepartmentEmployeeTreeItem:s},props:{isDepartment:{type:Boolean,default:!1}},data:function(){return{originalData:[],searchKeywords:"",eventbus:new l.default,currentSelect:null,treeData:[]}},computed:{},watch:{},filters:{},created:function(){},mounted:function(){this.getDepartmentEmployeeList()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{resetSearch:function(){this.searchKeywords="",this.getDepartmentEmployeeList()},getSelect:function(){return this.currentSelect},filterEmployee:function(){var e=this;this.originalData.forEach(function(t){e.recursionFilterEmployee(t)}),this.generateTreeData()},recursionFilterEmployee:function(e){var t=this;e.employees&&e.employees.forEach(function(e){""===t.searchKeywords||e.actualName.indexOf(t.searchKeywords)>-1?e.show=!0:e.show=!1}),e.children&&e.children.forEach(function(e){t.recursionFilterEmployee(e)})},filterDepartment:function(){var e=this;this.originalData.forEach(function(t){e.recursionFilterDepartment(t)}),this.generateTreeData()},recursionFilterDepartment:function(e){var t=this;e.children&&e.children.forEach(function(e){e.show=!0,t.recursionFilterDepartment(e)})},getDepartmentEmployeeList:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$Spin.show(),e.next=3,a.a.getDepartmentEmployeeList();case 3:t=e.sent,this.$Spin.hide(),this.originalData=t.data,this.isDepartment?this.filterDepartment():this.filterEmployee();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),generateTreeData:function(){var e=this,t=[];this.originalData.forEach(function(n){var r=1==n.type?"md-cube":"md-menu",a=Object.assign({},{title:n.name,expand:!0,children:e.constractTree(n),render:function(t,a){return a.root,a.node,a.data,t(s,{props:{isDepartment:e.isDepartment,itemData:{title:n.name,icon:r,isEmployee:!1,id:n.id,selectFunction:function(t){e.isDepartment&&(e.currentSelect=t,e.eventbus.$emit("select",t),e.$emit("on-select",t))}}},style:{cursor:"pointer"}})}});t.push(a)}),this.treeData=t},constractTree:function(e){var t=this,n=[];return e.children&&e.children.forEach(function(e){if(!t.isDepartment||e.show){var r=1==e.type?"md-cube":"md-menu",a=Object.assign({},{title:e.name,expand:!0,disabled:!1,children:t.constractTree(e),render:function(n,a){return a.root,a.node,a.data,n(s,{props:{isDepartment:t.isDepartment,itemData:{title:e.name,icon:r,isEmployee:!1,id:e.id,selectFunction:function(e){t.currentSelect=e,t.eventbus.$emit("select",e),t.$emit("on-select",e)}}},style:{cursor:"pointer"}})}});n.push(a)}}),!this.isDepartment&&e.employees&&e.employees.forEach(function(e){if(e.show){var r=Object.assign({},{title:e.actualName,render:function(n,r){return r.root,r.node,r.data,n(s,{props:{isDepartment:t.isDepartment,itemData:{title:e.actualName,icon:"md-person",isEmployee:!0,selected:!1,id:e.id,eventbus:t.eventbus,selectFunction:function(e){t.currentSelect=e,t.eventbus.$emit("select",e),t.$emit("on-select",e)}}},style:{cursor:"pointer"}})}});n.push(r)}}),n}}},u=Object(o.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"330px"}},[n("Row",[n("Col",{attrs:{span:"24"}},[e.isDepartment?e._e():n("Input",{staticStyle:{"max-width":"300px",position:"fixed","z-index":"9999"},attrs:{placeholder:"请输入员工名称"},on:{"on-change":e.filterEmployee},model:{value:e.searchKeywords,callback:function(t){e.searchKeywords=t},expression:"searchKeywords"}}),n("Tree",{staticStyle:{"margin-top":"40px"},attrs:{data:e.treeData}})],1)],1)],1)},[],!1,null,"07571098",null);t.a=u.exports},be28:function(e,t,n){},c1c3:function(e,t,n){"use strict";var r=n("0342");n.n(r).a},cc5e:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("1e04"),a={addRole:function(e,t){var n={remark:e,roleName:t};return Object(r.c)("/role/add",n)},deleteRole:function(e){return Object(r.a)("/role/delete/"+e)},updateRole:function(e,t,n){var a={id:e,remark:t,roleName:n};return Object(r.c)("/role/update",a)},getRoleDetail:function(e){return Object(r.a)("/role/get/"+e)},getAllRole:function(){return Object(r.a)("role/getAll")},getListEmployee:function(e){return Object(r.c)("/role/listEmployee",e)},getAllListEmployee:function(e){return Object(r.a)("/role/listAllEmployee/"+e)},deleteEmployeeRole:function(e){return Object(r.a)("/role/removeEmployee?employeeId="+e.employeeId+"&roleId="+e.roleId)},deleteEmployeeList:function(e){return Object(r.c)("/role/removeEmployeeList",e)},addEmployeeListRole:function(e){return Object(r.c)("/role/addEmployeeList",e)},getRoles:function(e){return Object(r.a)("/role/getRoles/"+e)}}}}]);